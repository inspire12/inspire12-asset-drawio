<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Rough.js SVG 저장 예제</title>
  <!-- Rough.js 라이브러리 CDN -->
  <script src="https://cdn.jsdelivr.net/npm/roughjs@4.3.1/bundled/rough.js"></script>
</head>
<body>
  <!-- SVG 영역 -->
  <svg id="svg" width="500" height="500"></svg>
  
  <!-- SVG 다운로드 버튼 -->
  <button id="downloadBtn">SVG 저장하기</button>
  
  <script>
    // SVG 요소 및 Rough.js 인스턴스 생성
    const svg = document.getElementById("svg");
    const rc = rough.svg(svg);
    
    // 예제: Rough 스타일의 사각형 생성
    const rect = rc.rectangle(50, 50, 200, 100, {
      stroke: 'black',
      strokeWidth: 2,
      roughness: 2,
      fill: 'none'
    });
    svg.appendChild(rect);
    
    // SVG 다운로드 함수
    function downloadSVG() {
      // SVG 요소를 문자열로 직렬화 (XMLSerializer 사용)
      const serializer = new XMLSerializer();
      let source = serializer.serializeToString(svg);
      
      // XML 헤더 추가 (필요에 따라)
      if (!source.match(/^<\?xml/)) {
        source = '<?xml version="1.0" standalone="no"?>\r\n' + source;
      }
      
      // Blob 객체 생성 및 다운로드 링크 생성
      const svgBlob = new Blob([source], { type: "image/svg+xml;charset=utf-8" });
      const url = URL.createObjectURL(svgBlob);
      const downloadLink = document.createElement("a");
      downloadLink.href = url;
      downloadLink.download = "diagram.svg";
      
      // 다운로드 링크 클릭하여 파일 저장
      document.body.appendChild(downloadLink);
      downloadLink.click();
      document.body.removeChild(downloadLink);
    }
    
    // 버튼 클릭 시 downloadSVG 함수 실행
    document.getElementById("downloadBtn").addEventListener("click", downloadSVG);
  </script>
</body>
</html>
